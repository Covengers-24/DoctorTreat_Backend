<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="doctorMypage">

	<!--마이페이지 정보 보여주기-->
	<select id="showInfo" parameterType="int" resultType="DoctorDTO">
	  SELECT 
      d.doctor_id ,
      d.doctor_name ,
      d.doctor_phone ,
      h.hospital_name ,
      h.hospital_call ,
      a.address_postal ,
      a.address_address ,
      a.address_detail 
      FROM dt_doctor d
      LEFT JOIN dt_hospital h ON d.hospital_number = h.hospital_number
      LEFT JOIN dt_address a ON h.address_number = a.address_number
      WHERE d.doctor_number = #{doctorNumber}
	</select>
	
	
	
	<!-- 비밀번호 인증 쿼리 -->
    <select id="checkPassword" parameterType="map" resultType="int">
        SELECT COUNT(*) 
        FROM dt_doctor
        WHERE doctor_id = #{doctorId} AND doctor_pw = #{doctorPw}
    </select>
    
    
    
	<!-- 회원탈퇴 셀렉트 -->
   <select id="doctorReceive" parameterType="doctorDTO" resultType="int">
      select doctor_number
      from dt_doctor
      where doctor_id=#{doctorId} and doctor_pw = #{doctorPw}
   </select>
   
   <!-- 회원탈퇴 -->
   <delete id="doctorQuit1" parameterType="int">
      delete from dt_doctor
      where doctor_number=#{doctorNumber}
   </delete>    

   <delete id="doctorQuit2" parameterType="int">
      delete from dt_address
      where doctor_number IN (
      SELECT DOC_NUMBER FROM DT_DOCTOR 
      WHERE DOC_NUMBER =  #{doctorNumber}
      )
   </delete>
   
   <delete id="doctorQuit3" parameterType="int">
      delete from dt_hospital
      where doctor_number IN (
      SELECT DOC_NUMBER FROM DT_DOCTOR 
      WHERE DOC_NUMBER =  #{doctorNumber}
      )
   </delete>
   
   
	
	










</mapper>